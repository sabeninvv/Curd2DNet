# Curd2DNet
Network for the classification of curds by foto

## Краткое описание
На вход сеть принимает: тензор размерности (150,150,2).
Обработка тензора: 
- 2 ветки Conv2D. В 1 ветке в Conv2D ядро, геометрии типа квадрат. Во 2 ветке - прямоугольник.
- После слияния concatenate, сжимается пространство и усредняется с помощью GlobalAveragePooling2D
- На слоях Conv2D используется функция активации 'relu'. На Dense - 'softmax'
- Для увеличения скорости обработки тензора, применены слои BatchNormalization
- Для сокращения переобучения сети - Dropout
На выходе: Softmax на 5 классов


## Архитектура сети
![Image alt](https://github.com/sabeninvv/Curd2DNet/blob/master/model_architecture.png)


## Предобработка данных
### Изображение в тензор:
- Загрузка цветного изображения
- Кадрирование изображения. Сравнивается высота и ширина, проигравший размер "вытягивается" без изменения размера изображения, "новая площадь" заполняется чёрным. 
- Изменение размера до 150х150
- Конвертирование изображение в градации серого
- Перевод изображение в тензор (150,150,2)
- Запись всех тензоров в Pandas DataFrame
### Балансировка данных:
- "Перемешивание" данных в каждом классе, используя np.random.shuffle
- Сравнение количества тензоров в каждом классе. 
- Вычисление класса с минимальным количеством тензоров.
- "Усечение" количества тензоров во всех классах до минимального.
- Нормализация данных в тензорах, делением на 255.


## Параметры обучения
- Для всех этапов: batch_size=64, loss='sparse_categorical_crossentropy', metrics=['accuracy'], фильтр по val_accuracy.
- 1 этап: epochs=100, optimizer=Adam(1e-3)
- 2 этап: epochs=50, optimizer=Adam(1e-4)
- 3 этап: epochs=50, optimizer=Adam(1e-5)
